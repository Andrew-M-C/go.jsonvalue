<font size=6>v1.3.x の新機能</font>

[前のページ](./14_1_14_new_feature.md) | [目次](./README.md) | [次のページ](./16_1_12_new_feature.md)

---

- [`%` はデフォルトでエスケープされません](#-はデフォルトでエスケープされません)
- [`encoding/json` からのインポート/エクスポートのサポート](#encodingjson-からのインポートエクスポートのサポート)
- [ジェネリクス風の操作のサポート](#ジェネリクス風の操作のサポート)
- [JSON値の比較](#json値の比較)
- [マーシャル時のインデントサポート](#マーシャル時のインデントサポート)
- [キーの元の順序の取得](#キーの元の順序の取得)
- [キーが設定された順序でのマーシャル](#キーが設定された順序でのマーシャル)
- [非表示ASCII文字のエスケープ](#非表示ascii文字のエスケープ)
- [MustXxx メソッド](#mustxxx-メソッド)
- [公式のマーシャラーとアンマーシャラーインターフェースのサポート](#公式のマーシャラーとアンマーシャラーインターフェースのサポート)

---

## `%` はデフォルトでエスケープされません

jsonvalue の以前のバージョンでは、`%` 文字がエスケープされていましたが、これは標準的な仕様ではありませんでした。v1.3.0 からは、`%` はデフォルトでエスケープされなくなりました。この機能が必要な場合は、[issue](https://github.com/Andrew-M-C/go.jsonvalue/issues/new) を作成してお知らせください。

## `encoding/json` からのインポート/エクスポートのサポート

詳細については、[`encoding/json` とのインポート・エクスポート](./06_import_export.md) の章を参照してください。この機能は v1.2.x ではベータ機能でしたが、v1.3.x で正式機能になりました。

## ジェネリクス風の操作のサポート

以前のバージョンでは、`*V` にサブ値を設定する際、以下のように型を明示的に指定する必要がありました：

```go
v.SetString("Hello, JSON!").At("msg")
v.SetInt64(time.Now().Unix()).At("time")
```

v1.3.0 からは、これを行う必要がなくなりました。有効なJSON値の任意の型を受け入れる `Set` を使用するだけで済みます：

```go
v.Set("Hello, JSON!").At("msg")
v.Set(time.Now().Unix()).At("time")
```

この機能は以下の関数でも利用可能です：

- `Append`
- `Insert`
- `Add`

さらに、v1.3.0 から `New` 関数も導入されました。これは実際には `Import` の簡単なラッパー関数です。詳細については、[`encoding/json` とのインポート・エクスポート](./06_import_export.md) の章を参照してください。

## JSON値の比較

2つのJSON値が等しいかどうかを比較する `Equal` メソッドが導入されました。また、パッケージ beta には [Contains](./13_beta.md) 関数も追加されました。

## マーシャル時のインデントサポート

詳細については、[追加オプション](./12_option.md) の章の「視覚的インデント」を参照してください。

## キーの元の順序の取得

詳細については、[反復処理](./07_iteration.md) の章の「オブジェクトの元のキー順序の取得」を参照してください。

## キーが設定された順序でのマーシャル

詳細については、[特別な応用シナリオ](./10_scenarios.md) の章の「キーが設定された順序でJSONオブジェクトをシリアライズ」を参照してください。

## 非表示ASCII文字のエスケープ

v1.3.1 から、キーや文字列型の値に非表示ASCII文字が含まれている場合、不適切な表示効果を防ぐために `\u00XX` 形式でエスケープされるようになりました。

## MustXxx メソッド

v1.3.4 から、`MustAdd`、`MustAppend`、`MustInsert`、`MustSet`、`MustDelete` メソッドが導入されました。これらのメソッドはサブ値やエラーを返しません。

## 公式のマーシャラーとアンマーシャラーインターフェースのサポート

v1.3.4 から、`*jsonvalue.V` は以下の公式インターフェースを実装するようになりました：

- `json.Marshaler`、`json.Unmarshaler`
- `encoding.BinaryMarshaler`、`encoding.BinaryUnmarshaler`

詳細については、[マーシャルとアンマーシャル](./05_marshal_unmarshal.md) を参照してください。
